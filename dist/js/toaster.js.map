{"version":3,"file":"toaster.js","sources":["../../../src/ts/toaster.ts"],"sourcesContent":["/*!\r\n * Toaster v2.0.1\r\n *\r\n * Kopimi 2023 Joshua Faulkenberry\r\n * Unlicensed under The Unlicense\r\n * http://unlicense.org/\r\n */\r\n\r\nimport \"../scss/toaster.scss\"\r\n\r\nexport default class Toaster {\r\n\r\n   static version     : string = \"2.0.1\"\r\n   static toastQueue  : {\r\n                           t: HTMLElement,\r\n                           o: any\r\n                        }[] = []\r\n   static currentToast: HTMLElement | null\r\n\r\n   el: HTMLDivElement\r\n   options: opts\r\n\r\n   constructor(msg: string, options: opts) {\r\n      this.el = document.createElement(\"div\")\r\n\r\n      this.options = {\r\n         ...{\r\n            timeout: 2500,\r\n            class: \"\",\r\n            duration: 1000,\r\n            anchor: \"bottom\",\r\n            icon: null,\r\n            click: null\r\n         }, ...options\r\n      }\r\n\r\n      var ico = this.options.icon ? `<div class=\"icon\"><i class=\"${this.options.icon}\"></i></div>` : \"\"\r\n\r\n      this.el.className = `toaster ${this.options[\"class\"]}`\r\n      this.el.innerHTML = `${ico}<div class=\"body\">${msg}</div>`\r\n\r\n      this.el.addEventListener(\"eat\", () => {\r\n         this.el.style.opacity = `1`;\r\n\r\n         (() => {\r\n            this.el.style.transition = `opacity ${this.options.duration}ms`\r\n            this.el.style.opacity = `0`\r\n            this.el.addEventListener(\"transitionend\", () => {\r\n               this.el.style.display = \"none\"\r\n               this.el.dispatchEvent(new Event('eaten'))\r\n               this.el.remove()\r\n\r\n               let x = document.querySelectorAll(\"div.toaster\").length\r\n               Array.from(document.querySelectorAll(\"div.toaster\")).forEach((tst: HTMLDivElement | any) => {\r\n                  x--\r\n                  tst.style[this.options.anchor] = (x * (tst.offsetHeight + parseInt(getComputedStyle(tst).marginBottom) + parseInt(getComputedStyle(tst).marginTop))) + \"px\"\r\n               })\r\n\r\n               this.swallow()\r\n            })\r\n         })()\r\n      })\r\n\r\n      if (this.options.click) {\r\n         this.el.style.cursor = \"pointer\"\r\n         this.el.addEventListener(\"click\", e => {\r\n            if (this.options.click) this.options.click(e)\r\n            this.el.dispatchEvent(new Event('eat'))\r\n         })\r\n      }\r\n\r\n      Toaster.toastQueue.push({\r\n         t: this.el,\r\n         o: this.options\r\n      });\r\n\r\n      (() => this.el.dispatchEvent(new Event('bake')))()\r\n\r\n      if (Toaster.toastQueue.length == 1) (() => Toaster.serve())()\r\n   }\r\n\r\n   eat() {\r\n      this.el.dispatchEvent(new Event('eat'))\r\n   }\r\n\r\n   swallow() {\r\n      this.el.remove()\r\n      Toaster.currentToast = null\r\n   }\r\n\r\n   static serve() {\r\n      if (!this.toastQueue.length) return\r\n      var tst = this.toastQueue[0].t\r\n      var options = this.toastQueue[0].o\r\n\r\n      document.body.appendChild(tst)\r\n      tst.style[options.anchor] = 0 - (tst.offsetHeight + parseInt(getComputedStyle(tst).marginBottom) + parseInt(getComputedStyle(tst).marginTop)) + \"px\"\r\n      tst.style.clipPath = `inset(0 0 ` + (tst.offsetHeight + parseInt(getComputedStyle(tst).marginBottom) + parseInt(getComputedStyle(tst).marginTop)) + `px)`;\r\n\r\n      (() => {\r\n         tst.style.transition = `clip-path ${options.duration}ms, ${options.anchor} ${options.duration}ms`\r\n         tst.style.clipPath = \"inset(0)\"\r\n         let x = document.querySelectorAll(\"div.toaster\").length\r\n\r\n         Array.from(document.querySelectorAll(\"div.toaster\")).forEach((el: HTMLDivElement | any) => {\r\n            x--\r\n            el.style[options.anchor] = ((x * (el.offsetHeight + parseInt(getComputedStyle(el).marginBottom) + parseInt(getComputedStyle(el).marginTop)))) + \"px\"\r\n         })\r\n      })()\r\n\r\n      this.currentToast = tst\r\n\r\n      this.currentToast?.dispatchEvent(new Event('baked'))\r\n\r\n      const next = (event: any) => {\r\n         if (event.propertyName != options.anchor) return\r\n         if (options.timeout) setTimeout(() => {\r\n            tst?.dispatchEvent(new Event('eat'))\r\n         }, options.timeout)\r\n\r\n         this.toastQueue.shift()\r\n         event.target.removeEventListener('transitionend', next, false)\r\n         event.target.dispatchEvent(new Event('served'))\r\n         if (this.toastQueue.length) this.serve()\r\n      }\r\n\r\n      this.currentToast?.addEventListener('transitionend', next)\r\n   }\r\n\r\n}"],"names":[],"mappings":"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"}