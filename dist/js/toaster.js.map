{"version":3,"file":"toaster.js","sources":["../../../../src/ts/toaster.ts"],"sourcesContent":["/*!\r\n * Toaster v2.1.4\r\n *\r\n * Kopimi 2025 Joshua Faulkenberry\r\n * Unlicensed under The Unlicense\r\n * http://unlicense.org/\r\n */\r\n\r\nimport type from \"../../toaster\"\r\n\r\nexport default class Toaster implements ToasterInstance {\r\n\r\n   readonly version = \"2.1.4\";\r\n   static toastQueue: { t: HTMLElement; o: Options }[] = []\r\n   static currentToast: HTMLElement | null = null\r\n\r\n   el = document.createElement(\"div\")\r\n   options\r\n\r\n   constructor(msg: string, options?: Partial<Options>) {\r\n      this.options = {\r\n         ...{\r\n            timeout: 2500,\r\n            class: \"\",\r\n            duration: 1000,\r\n            anchor: \"bottom\",\r\n            icon: null,\r\n            click: null\r\n         }, ...options\r\n      }\r\n\r\n      var ico = this.options.icon ? `<div class=\"icon\"><i class=\"${this.options.icon}\"></i></div>` : \"\"\r\n\r\n      this.el.className = `toaster ${this.options[\"class\"]}`\r\n      this.el.innerHTML = `${ico}<div class=\"body\">${msg}</div>`\r\n\r\n      this.el.addEventListener(\"eat\", () => {\r\n         this.el.style.opacity = `1`;\r\n\r\n         (() => {\r\n            this.el.style.transition = `opacity ${this.options.duration}ms`\r\n            this.el.style.opacity = `0`\r\n            this.el.addEventListener(\"transitionend\", () => {\r\n               this.el.style.display = \"none\"\r\n               this.el.dispatchEvent(new Event('eaten'))\r\n               this.el.remove()\r\n\r\n               let x = document.querySelectorAll(\"div.toaster\").length\r\n               Array.from(document.querySelectorAll(\"div.toaster\")).forEach((tst: HTMLDivElement | any) => {\r\n                  x--\r\n                  tst.style[(this.options.anchor as string)] = (x * (tst.offsetHeight + parseInt(getComputedStyle(tst).marginBottom) + parseInt(getComputedStyle(tst).marginTop))) + \"px\"\r\n               })\r\n\r\n               this.swallow()\r\n            })\r\n         })()\r\n      })\r\n\r\n      if (this.options.click) {\r\n         this.el.style.cursor = \"pointer\"\r\n         this.el.addEventListener(\"click\", e => {\r\n            if (this.options.click) this.options.click(e)\r\n            this.el.dispatchEvent(new Event('eat'))\r\n         })\r\n      }\r\n\r\n      Toaster.toastQueue.push({\r\n         t: this.el,\r\n         o: this.options\r\n      });\r\n\r\n      (() => this.el.dispatchEvent(new Event('bake')))()\r\n\r\n      if (Toaster.toastQueue.length == 1) (() => Toaster.serve())()\r\n   }\r\n\r\n   eat() {\r\n      this.el.dispatchEvent(new Event('eat'))\r\n   }\r\n\r\n   swallow() {\r\n      this.el.remove()\r\n      Toaster.currentToast = null\r\n   }\r\n\r\n   static serve() {\r\n      if (!Toaster.toastQueue.length) return\r\n      var tst = Toaster.toastQueue[0].t\r\n      var options = Toaster.toastQueue[0].o\r\n\r\n      document.body.appendChild(tst)\r\n      tst.style[(options.anchor as any)] = 0 - (tst.offsetHeight + parseInt(getComputedStyle(tst).marginBottom) + parseInt(getComputedStyle(tst).marginTop)) + \"px\"\r\n      tst.style.clipPath = `inset(0 0 ` + (tst.offsetHeight + parseInt(getComputedStyle(tst).marginBottom) + parseInt(getComputedStyle(tst).marginTop)) + `px)`;\r\n\r\n      (() => {\r\n         tst.style.transition = `clip-path ${options.duration}ms, ${options.anchor} ${options.duration}ms`\r\n         tst.style.clipPath = \"inset(-100%)\"\r\n         let x = document.querySelectorAll(\"div.toaster\").length\r\n\r\n         Array.from(document.querySelectorAll(\"div.toaster\")).forEach((el: HTMLDivElement | any) => {\r\n            x--\r\n            el.style[(options.anchor as any)] = ((x * (el.offsetHeight + parseInt(getComputedStyle(el).marginBottom) + parseInt(getComputedStyle(el).marginTop)))) + \"px\"\r\n         })\r\n      })()\r\n\r\n      Toaster.currentToast = tst\r\n\r\n      Toaster.currentToast?.dispatchEvent(new Event('baked'))\r\n\r\n      const next = (event: any) => {\r\n         if (event.propertyName != options.anchor) return\r\n         if (options.timeout) setTimeout(() => {\r\n            tst?.dispatchEvent(new Event('eat'))\r\n         }, options.timeout)\r\n\r\n         Toaster.toastQueue.shift()\r\n         event.target.removeEventListener('transitionend', next, false)\r\n         event.target.dispatchEvent(new Event('served'))\r\n         if (Toaster.toastQueue.length) this.serve()\r\n      }\r\n\r\n      Toaster.currentToast?.addEventListener('transitionend', next)\r\n   }\r\n\r\n}"],"names":[],"mappings":"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"}